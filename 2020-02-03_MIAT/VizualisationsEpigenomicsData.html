<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Fostering data re-use with interactive visualisations in transcriptomics and epigenomics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Guillaume Devailly" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link rel="stylesheet" href="libs/INRAE_metropolis.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">


class: inverse, bottom, font180, clear



# Fostering data re-use with interactive visualisations of transcriptomics and epigenomics data

&lt;html&gt;
  &lt;div style='float:left'&gt;&lt;/div&gt;
  &lt;hr color='#423089' size=1px width=100%&gt;
&lt;/html&gt;
.pull-left[

<i class="fab  fa-twitter "></i> [@G_Devailly](https://twitter.com/G_Devailly)

Guillaume Devailly  
SÃ©minaire MIAT  
2020/02/07
]
.pull-right[

![:img_scale 90%](img/INRAE_genphyse_logo_wb.svg)
]


---
layout: true
class: font160
background-image: url("img/INRAE_genphyse_logo.svg")
background-position: bottom left
background-size: 20%

---

# One genome, many cell types

.pull-left[
![](img/bioRender.png)
![:img_scale 15%](img/biorender_watermark.png)
]
.pull-right[
.centre[
Differential gene expression =  
cellular environment + epigenetics
]
]

---

# Transcriptomics &amp; Epigenomics data

.pull-left[
Each experiment is complex and costly, but many datasets and databases are available.

- Expression: RNA-seq
- Chromatin accessibility: DNAse1, ATAC-seq
- DNA methylation: WGBS
- ChIP-seq:
  * Transcription regulators
  * Histone variants
  * Histone modifications
]

.pull-right[
![:img_scale 25%](img/ENCODE_logo.png) ![:img_scale 40%](img/RoadmapEpigenomics.png) 

![](img/main_illustration.png)
]

---

# DNA methylation

![](img/dnameth.png)

---

# DNA methylation

.centre[
![:img_scale 25%](img/readers.png)
]

---

# Histone modification

&lt;iframe src="https://www.rcsb.org/3d-view/1AOI#stageViewport" width="100%" height="500px"&gt;&lt;/iframe&gt;

---

# Data re-use 

.pull-left[
### The good
- Mostly FAIR data, good enough metadata 

### The bad
- Domain expertise, experimental artefacts
- Arguable arbitrary choices during analyses
]

.pull-right[
![](img/elf1_1.png)
]

---

# Data re-use 

.pull-left[
### The good
- Mostly FAIR data, good enough metadata 

### The bad
- Domain expertise, experimental artefacts, 
- Discussable arbitrary choices during analyses

### The ugly
- Fat data, too lazy to download it all
]

.pull-right[
![](img/elf1_2.png)
1 experiment: 12.2 GB
]

---

# Genome browsers can help!

.left-column[
Few experiments at a time  
Few genes at a time
]
.right-column[
.centre[
![:img_scale 80%](img/elf1_3.png)
]
]

---
class: inverse, middle, font200
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Interactive visualisations to foster data re-use

&lt;html&gt;
  &lt;div style='float:left'&gt;&lt;/div&gt;
  &lt;hr color='#423089' size=1px width=100%&gt;
&lt;/html&gt;

1. **Heat*seq: interactive correlation heatmaps of transcriptomics and epigenomics datasets**

2. PEREpigenomics: Profile Explorer of Roadmap Epigenomics data

3. VizFaDa: Visualisations of FAANG data 

---

# Correlation heatmaps for transcriptomics and TF ChIP-seq datasets

![:img_scale 80%](img/heatstarseq_datasets.png)

---

# Heat*seq workflow

.centre[
![:img_scale 70%](img/heatstarseq_workflow.png)
]

---

# HeatRNAseq workflow

.centre[
![:img_scale 70%](img/heatstarseq_rna.png)
]

---

# HeatChIPseq workflow

.centre[
![:img_scale 70%](img/heatstarseq_chip.png)
]

---
class: centre

# Live Demo !

.font200[
ðŸ¤ž

[www.heatstarseq.roslin.ed.ac.uk](http://www.heatstarseq.roslin.ed.ac.uk/)
]

---

# Heat*seq conclusions &amp; perspectives

- App: [www.heatstarseq.roslin.ed.ac.uk](http://www.heatstarseq.roslin.ed.ac.uk/)
- Source code: [github.com/gdevailly/HeatStarSeq_gh](https://github.com/gdevailly/HeatStarSeq_gh)
- Publication: [doi.org/10.1093/bioinformatics/btw407](https://doi.org/10.1093/bioinformatics/btw407)

### Perspectives ?
- More datasets! (also, update the old ones...)
- More datatypes: Hitsone marks, gene lists, ...
- Multiple use files
- Gene name converter, liftover
- Datasets with more that 1000 experiments?

---

# Heat*seq thanks:

![:img_scale 80%](img/heatstarseq_thanks.png)

---
class: inverse, middle, font200
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Interactive visualisations to foster data re-use

&lt;html&gt;
  &lt;div style='float:left'&gt;&lt;/div&gt;
  &lt;hr color='#423089' size=1px width=100%&gt;
&lt;/html&gt;

1. Heat*seq: interactive correlation heatmaps of transcriptomics and epigenomics datasets

2. **PEREpigenomics: Profile Explorer of Roadmap Epigenomics data**

3. VizFaDa: Visualisations of FAANG data 

---

# The Roadmap Epigenomics dataset

.pull-left[
![](img/RoadmapEpigenomics.png)
- RNA-seq
- DNAse1
- WGBS,
- 10 different histone methylations
- 17 different histone acetylations
- 33 human cell lines &amp; tissues
- uniformly processed
]

.pull-right[
![](img/main_illustration.png)
]

---

# Objectives

.pull-left[
- Visualisation of marks, sorted by **gene** transcription level:
  - at TSS (gene start)
  - at TTS (gene end)
- Visualisation of marks at **middle exons** starts, sorted by:
  - transcription level
  - inclusion ratio
- For **all** genes/exons in **each** cell type.
- For **each** gene/exon in **all** cell types.
]

.pull-right[
![:img_scale 85%](img/h3k4me3_SI.png)
]

---
class: inverse
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# H3K4me3, TSS, small intestine

.centre[
![:img_scale 42%](img/h3k4me3_SI.png)
]


---
class: font180

# What is a gene?
.pull-left[
![:img_scale 100%](img/gencode22.png)
]
.pull-right[
![:img_scale 53%](img/gene_types.png)
]

---
class: font180

# Where is BRCA1's Transcription Start Site (TSS)?
![:img_scale 68%](img/Human_BRCA1_anno2.png)

---
# More genes than pixels on the device!

.pull-left[
![:img_scale 64%](img/overploting.png)
]

--
.pull-right[

```r
image(my_matrix, useRaster = TRUE)
```
-&gt; Reduce matrix dimension **before** plotting

```r
redim_matrix &lt;- function(
    mat,
    target_height = 100,
    target_width = 100,
    summary_func = function(x) mean(x, na.rm = TRUE),
    n_core = 1
) {
  ...
}
```

`summary_func`: `mean()`, `max()`, `mean_color()`, ... 
[cansnippet.bioinfo-fr.net/details.php?id=3](https://cansnippet.bioinfo-fr.net/details.php?id=3)

]

---
class: centre

# Ties shuffling
.pull-left[
![:img_scale 75%](img/E005_unshuffled.png)
]

--

.pull-right[
![:img_scale 75%](img/E005_shuffled.png)
]


---
class: centre

# Different gene types, different associations
.pull-left[
lincRNA  
![:img_scale 75%](img/h3k4me3_SI_lincRNA.png)
]
.pull-right[
processed pseudogenes  
![:img_scale 75%](img/h3k4me3_SI_propseudo.png)
]

---
class: centre

# Position of signal
.pull-left[
DNAse 1 (accessible chromatin)  
![:img_scale 75%](img/DNAse_SI.png)
]
.pull-right[
H3K27ac  
![:img_scale 75%](img/h3k27ac_SI.png)
]

---
class: inverse, centre
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Exonic mark: H3K36me3, foetal large intestine

![:img_scale 45%](img/H3K36me3.png)

---
class: font180

# DNA methylation: ratio *and* density

![:img_scale 90%](img/mCpG_density.svg)

---
class: font180

# DNA methylation: ratio *and* density

![:img_scale 100%](img/dname_ex1.png)

---
class: centre
# DNA methylation at TSS

WGBS, adult liver
![:img_scale 60%](img/wgbs_TSS_gene_FPKM_E066_all.png)

---
class: centre
# Exonic DNA methylation

WGBS, pancreas  
![:img_scale 60%](img/wgbs_panc_E098_all.png)

---

# Cell by cell *vs* gene by gene

.pull-left[
WGBS, adult liver
![](img/wgbs_TSS_gene_FPKM_E066_all.png)
]

--

.pull-right[
<div id="htmlwidget-1e7441af41c32acd41d3" style="width:504px;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1e7441af41c32acd41d3">{"x":{"data":[{"x":[0.00316054840450075,0.0104448345115661,0.0177291206186314,0.0250134067256967,0.032297692832762,0.0395819789398274,0.0468662650468927,0.054150551153958,0.0614348372610233,0.0687191233680886,0.076003409475154,0.0832876955822193,0.0905719816892846,0.0978562677963499,0.105140553903415,0.112424840010481,0.119709126117546,0.126993412224611,0.134277698331677,0.141561984438742,0.148846270545807,0.156130556652872,0.163414842759938,0.170699128867003,0.177983414974068,0.185267701081134,0.192551987188199,0.199836273295264,0.20712055940233,0.214404845509395,0.22168913161646,0.228973417723526,0.236257703830591,0.243541989937656,0.250826276044722,0.258110562151787,0.265394848258852,0.272679134365918,0.279963420472983,0.287247706580048,0.294531992687114,0.301816278794179,0.309100564901244,0.31638485100831,0.323669137115375,0.33095342322244,0.338237709329505,0.345521995436571,0.352806281543636,0.360090567650701,0.367374853757767,0.374659139864832,0.381943425971897,0.389227712078963,0.396511998186028,0.403796284293093,0.411080570400159,0.418364856507224,0.425649142614289,0.432933428721355,0.44021771482842,0.447502000935485,0.454786287042551,0.462070573149616,0.469354859256681,0.476639145363747,0.483923431470812,0.491207717577877,0.498492003684943,0.505776289792008,0.513060575899073,0.520344862006138,0.527629148113204,0.534913434220269,0.542197720327334,0.5494820064344,0.556766292541465,0.56405057864853,0.571334864755596,0.578619150862661],"y":[1.17193863545775,1.15216450566716,1.13239037587658,1.11261624608599,1.0928421162954,1.07306798650482,1.05329385671423,1.03351972692364,1.01374559713306,0.993971467342469,0.974197337551882,0.954423207761295,0.934649077970709,0.914874948180122,0.895100818389535,0.875326688598948,0.855552558808362,0.835778429017775,0.816004299227188,0.796230169436601,0.776456039646015,0.756681909855428,0.736907780064841,0.717133650274254,0.697359520483668,0.677585390693081,0.657811260902494,0.638037131111907,0.618263001321321,0.598488871530734,0.578714741740147,0.55894061194956,0.539166482158973,0.519392352368387,0.4996182225778,0.479844092787213,0.460069962996626,0.44029583320604,0.420521703415453,0.400747573624866,0.380973443834279,0.361199314043693,0.341425184253106,0.321651054462519,0.301876924671933,0.282102794881346,0.262328665090759,0.242554535300172,0.222780405509585,0.203006275718999,0.183232145928412,0.163458016137825,0.143683886347238,0.123909756556652,0.104135626766065,0.084361496975478,0.0645873671848916,0.0448132373943047,0.025039107603718,0.00526497781313107,-0.0145091519774556,-0.0342832817680425,-0.054057411558629,-0.0738315413492159,-0.0936056711398026,-0.113379800930389,-0.133153930720976,-0.152928060511563,-0.17270219030215,-0.192476320092736,-0.212250449883323,-0.23202457967391,-0.251798709464497,-0.271572839255084,-0.29134696904567,-0.311121098836257,-0.330895228626844,-0.35066935841743,-0.370443488208017,-0.390217617998604],"text":"","type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(51,102,255,1)","dash":"dot"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.00316054840450075],"y":[1.94825154256294],"text":"BLD.MOB.CD34.PC.F","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"BLD.MOB.CD34.PC.F","legendgroup":"BLD.MOB.CD34.PC.F","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.578619150862661],"y":[0.0326187608507199],"text":"BRN.CRTX.DR.NRSPHR","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(240,126,77,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(240,126,77,1)"}},"hoveron":"points","name":"BRN.CRTX.DR.NRSPHR","legendgroup":"BRN.CRTX.DR.NRSPHR","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.474270755712551],"y":[0.00817418400642635],"text":"BRN.GANGEM.DR.NRSPHR","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,134,25,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(231,134,25,1)"}},"hoveron":"points","name":"BRN.GANGEM.DR.NRSPHR","legendgroup":"BRN.GANGEM.DR.NRSPHR","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.295858828821127],"y":[0.617838747717003],"text":"BRN.GRM.MTRX","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(219,142,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(219,142,0,1)"}},"hoveron":"points","name":"BRN.GRM.MTRX","legendgroup":"BRN.GRM.MTRX","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.252406406714177],"y":[0.902002891350729],"text":"BRN.HIPP.MID","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(206,149,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(206,149,0,1)"}},"hoveron":"points","name":"BRN.HIPP.MID","legendgroup":"BRN.HIPP.MID","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.255905732109217],"y":[0.166430113843283],"text":"ESC.4STAR","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(191,156,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(191,156,0,1)"}},"hoveron":"points","name":"ESC.4STAR","legendgroup":"ESC.4STAR","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.345252615010015],"y":[0.178976947293169],"text":"ESC.H1","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(174,162,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(174,162,0,1)"}},"hoveron":"points","name":"ESC.H1","legendgroup":"ESC.H1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.282123940170781],"y":[0.17868923977559],"text":"ESC.HUES64","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(154,168,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(154,168,0,1)"}},"hoveron":"points","name":"ESC.HUES64","legendgroup":"ESC.HUES64","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.338292277702198],"y":[0.252124552505644],"text":"ESDR.CD184.ENDO","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(130,173,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(130,173,0,1)"}},"hoveron":"points","name":"ESDR.CD184.ENDO","legendgroup":"ESDR.CD184.ENDO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.327857465708273],"y":[0.225567713439471],"text":"ESDR.CD56.ECTO","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(100,178,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(100,178,0,1)"}},"hoveron":"points","name":"ESDR.CD56.ECTO","legendgroup":"ESDR.CD56.ECTO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.243667846383384],"y":[0.960090067904919],"text":"ESDR.CD56.MESO","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(50,182,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(50,182,0,1)"}},"hoveron":"points","name":"ESDR.CD56.MESO","legendgroup":"ESDR.CD56.MESO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.21999183310084],"y":[0.185825359612962],"text":"ESDR.H1.BMP4.MESO","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"ESDR.H1.BMP4.MESO","legendgroup":"ESDR.H1.BMP4.MESO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.299110187814634],"y":[0.0429690733931801],"text":"ESDR.H1.BMP4.TROP","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,189,92,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,189,92,1)"}},"hoveron":"points","name":"ESDR.H1.BMP4.TROP","legendgroup":"ESDR.H1.BMP4.TROP","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.203003974305245],"y":[0.209515014542631],"text":"ESDR.H1.MSC","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,120,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,191,120,1)"}},"hoveron":"points","name":"ESDR.H1.MSC","legendgroup":"ESDR.H1.MSC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.364600861195034],"y":[0.298853076409707],"text":"ESDR.H1.NEUR.PROG","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,192,145,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,192,145,1)"}},"hoveron":"points","name":"ESDR.H1.NEUR.PROG","legendgroup":"ESDR.H1.NEUR.PROG","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0833976962496815],"y":[1.10731174549067],"text":"GI.CLN.SIG","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,193,167,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,193,167,1)"}},"hoveron":"points","name":"GI.CLN.SIG","legendgroup":"GI.CLN.SIG","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.119834724410984],"y":[0.843108141999607],"text":"GI.ESO","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,192,187,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,192,187,1)"}},"hoveron":"points","name":"GI.ESO","legendgroup":"GI.ESO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.122400001604626],"y":[0.483444648098535],"text":"GI.L.INT.FET","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,190,205,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,190,205,1)"}},"hoveron":"points","name":"GI.L.INT.FET","legendgroup":"GI.L.INT.FET","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0934185678327754],"y":[0.937066312017428],"text":"GI.S.INT","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,222,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,222,1)"}},"hoveron":"points","name":"GI.S.INT","legendgroup":"GI.S.INT","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.332589287168289],"y":[0.374014740291912],"text":"GI.S.INT.FET","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,181,237,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,181,237,1)"}},"hoveron":"points","name":"GI.S.INT.FET","legendgroup":"GI.S.INT.FET","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0900075184297048],"y":[0.872389388417821],"text":"GI.STMC.GAST","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,174,249,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,174,249,1)"}},"hoveron":"points","name":"GI.STMC.GAST","legendgroup":"GI.STMC.GAST","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0526569056754552],"y":[0.898560644939712],"text":"HRT.ATR.R","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,166,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,166,255,1)"}},"hoveron":"points","name":"HRT.ATR.R","legendgroup":"HRT.ATR.R","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0682720620850734],"y":[0.870930358348696],"text":"HRT.VENT.L","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"HRT.VENT.L","legendgroup":"HRT.VENT.L","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.053951127197944],"y":[1.11968469182405],"text":"HRT.VNT.R","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(145,145,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(145,145,255,1)"}},"hoveron":"points","name":"HRT.VNT.R","legendgroup":"HRT.VNT.R","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.136368603048947],"y":[0.357553719743082],"text":"LIV.ADLT","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(179,133,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(179,133,255,1)"}},"hoveron":"points","name":"LIV.ADLT","legendgroup":"LIV.ADLT","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0707286689083505],"y":[1.23157152552842],"text":"LNG","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(205,121,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(205,121,255,1)"}},"hoveron":"points","name":"LNG","legendgroup":"LNG","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.169592869496849],"y":[0.290479813330673],"text":"MUS.PSOAS","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(225,111,248,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(225,111,248,1)"}},"hoveron":"points","name":"MUS.PSOAS","legendgroup":"MUS.PSOAS","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.110774205593195],"y":[0.778006461423508],"text":"OVRY","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(239,103,235,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(239,103,235,1)"}},"hoveron":"points","name":"OVRY","legendgroup":"OVRY","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.18550429235565],"y":[0.757320096546672],"text":"PANC","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(249,98,219,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(249,98,219,1)"}},"hoveron":"points","name":"PANC","legendgroup":"PANC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0927282912597219],"y":[0.33665982345442],"text":"SKIN.PEN.FRSK.KER.03","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,97,202,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,97,202,1)"}},"hoveron":"points","name":"SKIN.PEN.FRSK.KER.03","legendgroup":"SKIN.PEN.FRSK.KER.03","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0278424927774741],"y":[1.92847778688235],"text":"SPLN","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,99,182,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,99,182,1)"}},"hoveron":"points","name":"SPLN","legendgroup":"SPLN","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0475566875160588],"y":[1.10917342142547],"text":"THYM","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,104,160,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,104,160,1)"}},"hoveron":"points","name":"THYM","legendgroup":"THYM","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.0552493038253077],"y":[1.08795878946073],"text":"VAS.AOR","type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,111,136,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,111,136,1)"}},"hoveron":"points","name":"VAS.AOR","legendgroup":"VAS.AOR","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0.5],"y":[1.85,1.65],"text":["slope: -2.71","RÂ²: 0.56"],"hovertext":["",""],"textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":40.8401826484018,"r":7.30593607305936,"b":37.2602739726027,"l":48.9497716894977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"LYL1 (ENSG00000104903)","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.0256123817184073,0.607392080985569],"tickmode":"array","ticktext":["0.0","0.2","0.4","0.6"],"tickvals":[-3.46944695195361e-18,0.2,0.4,0.6],"categoryorder":"array","categoryarray":["0.0","0.2","0.4","0.6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"mean mCpG/CpG ratio at TSS +/-500bp","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.507141076026681,2.06517500059102],"tickmode":"array","ticktext":["-0.5","0.0","0.5","1.0","1.5","2.0"],"tickvals":[-0.5,0,0.5,1,1.5,2],"categoryorder":"array","categoryarray":["-0.5","0.0","0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"log10(FPKM+1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"233466639f5a":{"x":{},"y":{},"type":"scatter"},"233441c1e194":{"text":{},"colour":{},"x":{},"y":{}},"233468bc191c":{"x":{},"y":{}}},"cur_data":"233466639f5a","visdat":{"233466639f5a":["function (y) ","x"],"233441c1e194":["function (y) ","x"],"233468bc191c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]

---
# Repressing and activating marks

.pull-left[
### mCpG ratio
![:img_scale 80%](img/all_genes_wgbs.png)
]

--

.pull-right[
### H3K4me3
![:img_scale 80%](img/all_genes_h3k4.png)
]

---
class: inverse, centre
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Too many plots?

.centre[
![:img_scale 75%](img/explosion.png)
]

---
# PEREpigenomics

*P*rofile *E*xplorer of *R*oadmap *Epigenomic* data  
[joshiapps.cbu.uib.no/perepigenomics_app/](https://joshiapps.cbu.uib.no/perepigenomics_app/)

.centre[
![:img_scale 50%](img/perepigenomics.png)
]

---
# Summary of results

.pull-left[
&lt;table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; mark &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; cell type by cell type &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene by gene &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; center on TSS &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: ivory !important;"&gt;WGBS&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;negative&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;negative&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: ivory !important;"&gt;DNAse&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: ivory !important;"&gt;H2A.Z&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;balanced&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K4me1&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K4me2&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K4me3&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K9me3&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;unclear&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;unclear&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K23me2&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: grey !important;"&gt;NA&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K27me3&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;negative â€“ variable&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;negative&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K36me3&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K79me1&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: paleturquoise !important;"&gt;H3K79me2&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;balanced&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; no &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.pull-right[
&lt;table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; mark &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; cell type by cell type &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gene by gene &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; center on TSS &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2AK5ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2BK120ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2BK12ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2BK15ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;balanced&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2BK20ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: firebrick !important;"&gt;neutral&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: grey !important;"&gt;NA&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H2BK5ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K4ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K9ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K14ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K18ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K23ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K27ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H3K56ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: grey !important;"&gt;NA&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H4K8ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H4K12ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: grey !important;"&gt;NA&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: lightblue !important;"&gt;H4K91ac&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; &lt;span style="     color: darkgreen !important;"&gt;positive&lt;/span&gt; &lt;/td&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

]

---

## Conclusions

PEREpigenomics offers interesting visualisations of epigenetic data gathered by
Roadmap Epigenomics.

## Perspectives

- documentation
- preprint
- develop similar approach for [FAANG](http://data.faang.org/home) (Functional Annotation of the Animal Genomes) data

---
class: inverse, middle, font200
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Interactive visualisations to foster data re-use

&lt;html&gt;
  &lt;div style='float:left'&gt;&lt;/div&gt;
  &lt;hr color='#423089' size=1px width=100%&gt;
&lt;/html&gt;

1. Heat*seq: interactive correlation heatmaps of transcriptomics and epigenomics datasets

2. PEREpigenomics: Profile Explorer of Roadmap Epigenomics data

3. **VizFaDa: Visualisations of FAANG data** 
.left[
ANR Flash open sciences
![:img_scale 25%](img/anr-logo.png)
]

---

# VizFaDa: Visualisations of FAANG data

.pull-left[
![:img_scale 50%](img/FAANG_WebLogo.png)
### The 'ENCODE' of farm animal genomes
- open international consortium
- sharing data about gene expression and regulation
- metadata standards
- open data: [data.faang.org](https://data.faang.org/home)
]
.pull-right[
**Objective:** to provide interactive visualisations of FAANG data straight from the data portal
![](img/data_faang_sh.png)
]

---

# Expected results

.pull-left[
### Correlation heatmaps
- broad view of the dataset
- quick comparison with user-provided data
- identification of outlier experiments 
![](img/heatrnaseq_ex1.png)
]
.pull-right[
### Stack profiles of epigenetic marks and gene expression level
- rich and informative visualisations
- can reveal complex biological or artefactual associations 
![:img_scale 50%](img/h3k4me3_SI.png)
]

---

# People involved
We are recruiting (IE CDD 18m): [genphyse.toulouse.inra.fr/job-offers](https://genphyse.toulouse.inra.fr/content/bioinformatics-engineer-ie-fixed-term-18-months-inrae-toulouse-france)

### GenPhySe:
- **Guillaume Devailly**: data processing &amp; visualisations
- **Sylvain Foissac**: scientific expertise, link with FAANG

### Sigenae:
- **Philippe Bardou**: web application development
- **Patrice Dehais**: system administrator

### EMBL-EBI:
- **Peter Harrison**: FAANG data coordination centre
- **Guy Cochrane**: FAANG data coordination centre

---
class: inverse, centre
background-image: url("img/INRAE_genphyse_logo_wb.svg")

# Thank you for your attention!
![:img_scale 60%](img/Super_Pig_bloomberg.gif)
.font50[
[www.bloomberg.com/news/features/2019-12-03/china-and-the-u-s-are-racing-to-create-a-super-pig](https://www.bloomberg.com/news/features/2019-12-03/china-and-the-u-s-are-racing-to-create-a-super-pig)
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script src="libs/devailly.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "p. %current%",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
