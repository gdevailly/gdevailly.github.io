"AX-116489818",
"AX-116522437",
"AX-116552172",
"AX-116635573",
"AX-116768209",
"AX-116780994",
"DRGA0001106")
temp <- NULL
temp1 <- NULL
for ( carac in Liste_carac)
{
liste_SNP_signif <- liste
for (gener in 1:9)
{
dd <- fread(paste("~/mnt/genotoul_edelpuech/work/GWAS/RESULTATS/GEMMA_output_per_generation/G1_to_G9_perLINE/G",gener,"/gwas_GEMMA_P2_per_generation_HRFI_G",gener,"_",carac,".assoc.txt",sep=""),h=T)
dd$Gener <- paste("G",gener,sep="")
dd$carac <- carac
temp <- rbind(temp,dd[dd$rs%in%liste_SNP_signif,])
dd1 <- fread(paste("~/mnt/genotoul_edelpuech/work/GWAS/RESULTATS/GEMMA_output_per_generation/G1_to_G9_perLINE/G",gener,"/gwas_GEMMA_P2_per_generation_LRFI_G",gener,"_",carac,".assoc.txt",sep=""),h=T)
dd1$Gener <- paste("G",gener,sep="")
dd1$carac <- carac
temp1 <- rbind(temp1,dd1[dd1$rs%in%liste_SNP_signif,])
}
}
View(temp)
head(temp)
write.table(temp,"res_HRFI_ju.txt",quote=F,row.names=F,sep="\t")
write.table(temp,"res_LRFI_ju.txt",quote=F,row.names=F,sep="\t")
length(unique(temp$rs))
length(unique(temp1$rs))
dim(temp)
dim(temp1)
4 + 7.5 + 1.5
40-13
1500 / 27
blogdown::serve_site()
library(ggplot2)
library(tidyverse) # pour les fonctions fct_reorder / stringr
library(plyr) # pour la fonction dplyr
# création du dataframe
Num_etablissement <- rep ( c(1,2,3,2),10)
Champ <- rep ( c("Grand champ","Petit champ"),40)
Ecart_PDS_chp <-rnorm(40, mean=1, sd= 6)
df1 <- data.frame(Num_etablissement,Champ, Ecart_PDS_chp)
# création du dataframe modifié et calcul des quantiles
annot_data <- df1 %>%
group_by(Champ) %>%
dplyr::mutate(n = n(), centres = n_distinct(Num_etablissement) , q1=round(quantile(Ecart_PDS_chp, 0.25),1),
q3=round(quantile(Ecart_PDS_chp, 0.75),1),
med=round(median(Ecart_PDS_chp, na.rm=TRUE),1)  ) %>%
ungroup() %>%
mutate(x_label = paste0(Champ, "\nn=", n, "\n", centres,  " centres"  ))
# création du graphique
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=4)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=4, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=4, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=1)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=1, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=1, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label -1, y=med, label = med),  hjust=1)+
geom_text(data=annot_data, aes(x=x_label -1, y=q1, label = q1), hjust=1, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label -1, y=q3, label = q3), hjust=1, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=1, nudge_x = -1)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=1, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=1, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=1, nudge_x = -0.1)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=1, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=1, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=1, nudge_x = -0.2)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=1, nudge_x = -0.2, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=1, nudge_x = -0.2, colour="grey50")
g1
g1 <- ggplot(annot_data , aes( x = x_label, y = Ecart_PDS_chp, fill=Champ)) +
geom_boxplot(colour="grey50", width=0.4) +
xlab("")+ylab("Ecarts PDS affiché/mesuré (%)")+
coord_cartesian ( ylim= c(-20,20))+
geom_text(data=annot_data, aes(x=x_label, y=med, label = med),  hjust=1, nudge_x = -0.25)+
geom_text(data=annot_data, aes(x=x_label, y=q1, label = q1), hjust=1, nudge_x = -0.25, colour="grey50")+
geom_text(data=annot_data, aes(x=x_label, y=q3, label = q3), hjust=1, nudge_x = -0.25, colour="grey50")
g1
dimnames(gaiser)
dimnames(geiser)
mtcars
dimnames(mtcars)
mydf <- data.frame(variable = 1:5, x1 = 1:5)
mydf
mydf$v[2]
2050 * 0.85
?quiet
??quiet
mtcars
4500/800
18.43*26
18.43*4
479.18+73.72
8*4.09
4.52*2
9.04+4*4.09
25.4+32.72
58.12+1.20
library(tidyverse)
tribble
?tribble
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = vals, coulor = X)) +
geom_col()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = val, coulor = X)) +
geom_col()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = val, color = X)) +
geom_col()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = val, fill = X)) +
geom_col()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = val, group = X)) +
geom_col()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% ggplot(aes(x = Y, y = val, fill = X)) +
geom_col(position = "dodge")
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% gather()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% gather(-X, -Y)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread()
?spread
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = c("X", "Y"), value = val)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = c("X", "Y"), value = "val")
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = c("X", "Y"), value = val)
?melt_csv
??melt
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val) %>%
chisq.test()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val) %>%
select(-X) %>%
chisq.test()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val) %>%
select(-X) %>%
chisq.test(byrow=T)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val) %>%
select(-X) %>%
chisq.test(correct=F)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% spread(key = Y, value = val) %>%
select(-X)
matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T)
matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T) %>%
chisq.test()
matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T) %>%
chisq.test(correct = F)
barplot(matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T))
barplot(matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T), beside = T)
d <- matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T)
dimnames(d)
dimnames(d) <- list(c("x1", "x2"), c("y1", "y2", "y3", "y4"))
dimnames(d) <- list(c("x1", "x2"), c("y1", "y2", "y3", "y4", "y5"))
barplot(d, beside = T)
barplot(d, beside = T, legend.text = T)
d
chisq.test(d)
prop.test(d)
prop.test(d[, 2:3])
chisq.test(d[, 2:3])
stats::TukeyHSD(d)
stats::TukeyHSD(chisq.test(d))
stats::TukeyHSD(lm(d))
stats::TukeyHSD(aov(d))
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% lm(val ~ X +Y, data = .)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% lm(val ~ X +Y, data = .) %>% TukeyHSD()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
) %>% aov(val ~ X +Y, data = .) %>% TukeyHSD()
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
)
tribble(
~X, ~Y, ~val,
"x1", "y1", 21.667,
"x1", "y2", 41.667,
"x1", "y3", 37.778,
"x1", "y4", 13.889,
"x1", "y5", 5,
"x2", "y1", 17.333,
"x2", "y2", 33.333,
"x2", "y3", 30.22,
"x2", "y4", 11.111,
"x2", "y5", 4
)
?prop.test
smokers  <- c( 83, 90, 129, 70 )
patients <- c( 86, 93, 136, 82 )
prop.test(smokers, patients)
d <- matrix(c(14, 35, 49, 18, 4, 25, 40, 19, 7, 5), 2, 5, byrow = T)
prop.test(d[1, ], d[2, ])
d[1, ]
d[2, ]
dd <- d
dd[2, ] <- dd[2,]+dd[1,]
prop.test(dd[1, ], dd[2, ])
d
fisher.test(d)
m=fisher.test(d)
str(m)
summary(m)
m
sqrt(168)
sqrt(168)/2
60*24*7
/12
10080/12
10080/3000
install.packages("xaringan")
icon::fa("twitter")
xaringan:::list_css()
names(xaringan:::list_css())
setwd("~/mnt/inra_p/presentations/2019-02-03_MIAT")
xaringan::summon_remark()
